unk_602320="""31 80 63 32 32 64 80 33  34 12 36 01 38 32 32 39
34 03 36 23 39 34 1B 36  00 64 00 36 00 64 80 30
67 56 6B 59 70 33 73 36  76 39 79 24 42 26 45 29
48 40 4D 63 51 65 54 68  57 6D 5A 71 34 74 37 77
21 7A 25 43 2A 46 2D 4A  61 4E 64 52 67 55 6A 58
6E 32 72 35 75 38 78 2F  41 3F 44 28 47 2B 4B 62
50 65 53 68 56 6D 59 70  33 73 36 76 39 79 24 42
26 45 29 48 40 4D 63 51  66 54 6A 57 6E 5A 72 34
74 37 77 21 7A 25 43 2A  46 2D 4A 61 4E 64 52 67
55 6B 58 70 32 73 35 76  38 78 2F 41 3F 44 28 47
2B 4B 62 50 65 53 68 56  6D 59 71 33 74 36 77 39
7A 24 42 26 45 29 48 40  4D 63 51 66 54 6A 57 6E
5A 72 34 75 37 78 21 41  25 44 2A 46 2D 4A 61 4E
64 52 67 55 6B 58 70 32  73 35 76 38 79 2F 42 3F
45 28 48 2B 4B 62 50 65  53 68 56 6D 59 71 33 74
36 77 39 7A 24 43 26 46  29 4A 40 4E 63 51 66 54
6A 57 6E 5A 72 34 75 37  78 21 41 25 44 2A 47 2D
4B 61 50 64 53 67 55 6B  58 70 32 73 35 76 38 79
2F 42 3F 45 28 48 2B 4D  62 51 65 54 68 57 6D 59
71 33 74 36 77 39 7A 24  43 26 46 29 4A 40 4E 63
52 66 55 6A 58 6E 32 72  34 75 37 78 21 41 25 44
2A 47 2D 4B 61 50 64 53  67 56 6B 59 70 33 73 36
76 39 79 2F 42 3F 45 28  48 2B 4D 62 51 65 54 68
57 6D 5A 71 34 74 37 77  21 7A 25 43 26 46 29 4A
40 4E 63 52 66 55 6A 58  6E 32 72 35 75 38 78 2F
41 3F 44 28 47 2D 4B 61  50 64 53 67 56 6B 59 70
33 73 36 76 39 79 24 42  26 45 29 48 40 4D 62 51
65 54 68 57 6D 5A 71 34  74 37 77 21 7A 25 43 2A
46 2D 4A 61 4E 64 52 66  55 6A 58 6E 32 72 35 75
38 78 2F 41 3F 44 28 47  2B 4B 62 50 65 53 68 56
6B 59 70 33 73 36 76 39  79 24 42 26 45 29 48 40
4D 63 51 66 54 6A 57 6E  5A 71 34 74 37 77 21 7A
25 43 2A 46 2D 4A 61 4E  64 52 67 55 6B 58 70 32
73 35 75 38 78 2F 41 3F  44 28 47 2B 4B 62 50 65""".split()
unk_602320=[int("0x"+x,16) for x in unk_602320]

unk_6020E0="""31 80 32 32 64 80 33 32  34 28 35 36 63 37 36 98
38 61 62 31 80 36 0A 38  65 39 34 20 36 00 64 00
36 01 38 32 32 37 34 02  30 2A 47 2D 4B 61 50 64
53 67 56 6B 59 70 32 73  35 76 38 79 2F 42 3F 45
28 48 2B 4D 62 51 65 54  68 57 6D 5A 71 34 74 36
77 39 7A 24 43 26 46 29  4A 40 4E 63 52 66 55 6A
58 6E 32 72 35 75 38 78  21 41 25 44 2A 47 2D 4B
61 50 64 53 67 56 6B 59  70 33 73 36 76 39 79 24
42 3F 45 28 48 2B 4D 62  51 65 54 68 57 6D 5A 71
34 74 37 77 21 7A 25 43  2A 46 29 4A 40 4E 63 52
66 55 6A 58 6E 32 72 35  75 38 78 2F 41 3F 44 28
47 2B 4B 61 50 64 53 67  56 6B 59 70 33 73 36 76
39 79 24 42 26 45 29 48  40 4D 63 51 65 54 68 57
6D 5A 71 34 74 37 77 21  7A 25 43 2A 46 2D 4A 61
4E 64 52 67 55 6A 58 6E  32 72 35 75 38 78 2F 41
3F 44 28 47 2B 4B 62 50  65 53 68 56 6D 59 70 33
73 36 76 39 79 24 42 26  45 29 48 40 4D 63 51 66
54 6A 57 6E 5A 72 34 74  37 77 21 7A 25 43 2A 46
2D 4A 61 4E 64 52 67 55  6B 58 70 32 73 35 76 38
78 2F 41 3F 44 28 47 2B  4B 62 50 65 53 68 56 6D
59 71 33 74 36 77 39 7A  24 42 26 45 29 48 40 4D
63 51 66 54 6A 57 6E 5A  72 34 75 37 78 21 41 25
44 2A 46 2D 4A 61 4E 64  52 67 55 6B 58 70 32 73
35 76 38 79 2F 42 3F 45  28 48 2B 4B 62 50 65 53
68 56 6D 59 71 33 74 36  77 39 7A 24 43 26 46 29
4A 40 4E 63 51 66 54 6A  57 6E 5A 72 34 75 37 78
21 41 25 44 2A 47 2D 4B  61 50 64 53 67 55 6B 58
70 32 73 35 76 38 79 2F  42 3F 45 28 48 2B 4D 62
51 65 54 68 57 6D 59 71  33 74 36 77 39 7A 24 43
26 46 29 4A 40 4E 63 52  66 55 6A 58 6E 32 72 34
75 37 78 21 41 25 44 2A  47 2D 4B 61 50 64 53 67
56 6B 59 70 33 73 36 76  39 79 2F 42 3F 45 28 48
2B 4D 62 51 65 54 68 57  6D 5A 71 34 74 37 77 21
7A 25 43 26 46 29 4A 40  4E 63 52 66 55 6A 58 6E
32 72 35 75 38 78 2F 41  3F 00 00 00 00 00 00 00""".split()
unk_6020E0=[int("0x"+x,16) for x in unk_6020E0]

off_400E38="""loc_4008C5 loc_4008CF loc_400918
loc_400945 loc_400982 loc_4009C1
loc_400A08 loc_400A3C loc_400A91
loc_400AE6 sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F sub_40087F sub_40087F
sub_40087F loc_400B3E loc_400B74
loc_400BD2 loc_400BF4 loc_400C3D""".split()

src="""18 72 A2 A4 9D 89 1F A2  8D 9B 94 0D 6D 9B 95 EC
EC 12 9B 94 23 16 9B 6C  13 0E 6D 0D 96 8D 0E 90
13 97 8A BB CF 64 7E D3  1A 40 23 EC DF 00""".split()
src=[int("0x"+x,16) for x in src]

s=[0]*1280
test_str="AAAABBBBCCCCDDDD"
for x in range(len(test_str)):
    s[x]=ord(test_str[x])

byte_6025A0=[0]*256

counter=0
rbp_8=0
unk=unk_602320
dword_602580=0
#(a1-40) unk
#(a1-4) counter
#(a1-8) rbp_8
#s input

def loc_4008C5():
    return 1

def sub_40087F():
    pass

def loc_4008CF():
    global counter
    global rbp_8
    a=unk[counter]
    counter+=1
    a=byte_6025A0[a]
    s[rbp_8+256]=a
    rbp_8+=1

def loc_400918():
    global rbp_8
    s[rbp_8 + 256] = s[rbp_8 + 255]
    rbp_8+=1

def loc_400945():
    s[rbp_8 + 255] = s[s[rbp_8 + 255]]

def loc_400982():
    global counter
    global rbp_8
    a=unk[counter]
    counter+=1
    if s[rbp_8 + 255]==0:
        counter=a
    rbp_8-=1

def loc_4009C1():
    a=s[rbp_8 + 255]
    a=(a << 7) | (a >> 1)
    s[rbp_8 + 255] = a & 0xFF

def loc_400A08():
    global counter
    global rbp_8
    a=unk[counter]
    counter+=1
    s[rbp_8 + 256]=a & 0xFF
    rbp_8+=1

def loc_400A3C():
    global rbp_8
    a = s[rbp_8 + 255]
    b = s[rbp_8 + 254]
    a ^= b
    s[rbp_8 + 254] = a & 0xFF
    rbp_8-=1

def loc_400A91():
    global rbp_8
    a = s[rbp_8 + 255]
    b = s[rbp_8 + 254]
    a += b
    s[rbp_8 + 254] = a & 0xFF
    rbp_8-=1

def loc_400AE6():
    global rbp_8
    a = s[rbp_8 + 255]
    b = s[rbp_8 + 254]
    a = b - a
    s[rbp_8 + 254] = a & 0xFF
    rbp_8-=1

def loc_400B3E():
    a = s[rbp_8 + 255]
    a = ~a
    s[rbp_8 + 255] = a & 0xFF

def loc_400B74():
    global dword_602580
    dword_602580+=1

def loc_400BD2():
    byte_6025A0[0] = 1
    for x in range(len(src)):
        byte_6025A0[10+x]=src[x]

def loc_400BF4():
    global counter
    global rbp_8
    a=unk[counter]
    counter+=1
    b = s[rbp_8 + 255]
    rbp_8-=1
    byte_6025A0[a] = b

def loc_400C3D():
    a = s[rbp_8 + 255]
    a = byte_6025A0[a]
    s[rbp_8 + 255] = a

def run():
    global counter
    global rbp_8
    counter=0
    rbp_8=0
    while True:
        current=(unk[counter]-0x30) & 0xFF
        func=off_400E38[current]
        counter+=1
        if current>0x35:
            continue
        ret=eval(func+"()")
        if ret:
            break

unk=unk_602320
run()
print(s)
unk=unk_6020E0
run()
print(s)
